image: freebsd/latest
packages:
  - devel/gmake
  - devel/icu
  - devel/meson
  - devel/pkgconf
  - graphics/freeimage
  - graphics/libGLU
  - graphics/libjpeg-turbo
  - graphics/libnsgif
  - graphics/librsvg2
  - graphics/png
  - graphics/tiff
  - sysutils/cmocka
  - textproc/asciidoc
  - x11-toolkits/pango
  - x11/libxcb
  - x11/libxkbcommon
sources:
  - https://git.sr.ht/~exec64/imv
tasks:
  - make: |
      cd imv
      sed -i -e 's/BACKEND_\(.*\)=no/BACKEND_\1=yes/' config.mk
      cat config.mk
      gmake
      gmake check
  - meson: |
      meson imv build -D auto_features=enabled -D c_link_args='-L/usr/local/lib'
      ninja -C build test
